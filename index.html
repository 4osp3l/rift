<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rift</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.5.0/lz-string.min.js"></script>
<style>
:root{--bg:#0b0f13;--card:rgba(255,255,255,0.04);--accent:rgba(99,102,241,0.95);--glass:rgba(255,255,255,0.03);--muted:rgba(255,255,255,0.45);--glass-border:rgba(255,255,255,0.06);font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;}
*{box-sizing:border-box}html,body{height:100%;margin:0;background:#0b0f13;color:#e6eef8;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;padding:20px;display:flex;align-items:center;justify-content:center;}
.app{width:95vw;height:90vh;border-radius:14px;display:grid;grid-template-columns:400px 1fr;gap:18px;background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 10px 40px rgba(2,6,23,0.7);border:1px solid rgba(255,255,255,0.03);padding:18px;backdrop-filter:blur(8px) saturate(120%);}
.left,.right{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:16px;border-radius:10px;border:1px solid var(--glass-border);display:flex;flex-direction:column;overflow:auto;}
.left h1{font-size:18px;margin:0}
.left p.lead{margin:0;color:var(--muted);font-size:13px}
.dropzone{border:1px dashed rgba(255,255,255,0.06);padding:12px;border-radius:8px;min-height:96px;display:flex;align-items:center;justify-content:center;text-align:center;cursor:pointer;background:linear-gradient(180deg, rgba(255,255,255,0.008), transparent);}
input[type=file]{display:none}
.files{flex:1;overflow:auto;padding-top:6px}
.filelist{list-style:none;padding:0;margin:0}
.fileitem{display:flex;align-items:center;gap:10px;padding:8px;border-radius:8px;margin-bottom:6px;background:var(--card);cursor:pointer;border:1px solid rgba(0,0,0,0.1)}
.fileitem:hover{transform:translateY(-2px)}
.fileicon{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,var(--glass),transparent);border:1px solid rgba(255,255,255,0.02)}
.fname{font-size:13px}.fsmall{font-size:12px;color:var(--muted)}
.actions{display:flex;gap:8px}
.btn{padding:10px 12px;border-radius:8px;border:none;cursor:pointer;font-weight:600}
.btn-primary{background:var(--accent);color:white}
.btn-ghost{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.04)}
.preview{flex:1;overflow:auto;border-radius:8px;padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));border:1px solid rgba(255,255,255,0.02)}
.toolbar{display:flex;align-items:center;gap:8px;margin-bottom:12px}
.empty{display:flex;align-items:center;justify-content:center;height:100%;color:var(--muted);font-size:14px}
pre.code{white-space:pre-wrap;word-break:break-word;background:rgba(0,0,0,0.25);padding:12px;border-radius:8px;color:#dff;max-height:100%;overflow:auto}
.sharebox{display:flex;gap:8px;align-items:center}
.shareinput{flex:1;padding:10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
.note{font-size:12px;color:var(--muted)}
footer{font-size:12px;color:var(--muted);text-align:center;margin-top:10px}
@media (max-width:900px){.app{grid-template-columns:1fr;grid-auto-rows:420px}}
</style>
</head>
<body>
<div class="app" role="application" aria-label="ReconShare">
<div class="left">
<h1>Rift</h1>
<p class="lead">Upload your target recon data (.zip) and preview files in-browser.</p>
<label class="dropzone" id="dropzone">Drop .zip here or <strong style="color:var(--accent)"> browse</strong>
<input id="fileinput" type="file" accept=".zip" />
</label>
<div class="meta" id="meta">No file loaded</div>
<div class="files">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
<strong>Files</strong>
<div class="actions">
<button class="btn btn-ghost" id="downloadAll">Download file</button>
</div>
</div>
<ul class="filelist" id="filelist"></ul>
</div>
<div style="display:flex;flex-direction:column;gap:6px;margin-top:6px">
<div class="note"></div>
</div>
</div>
<div class="right">
<div class="toolbar">
<div style="flex:1">Preview</div>
<div style="display:flex;gap:8px;align-items:center">
<button class="btn" id="clear">Clear</button>
</div>
</div>
<div class="preview" id="preview">
<div class="empty" id="empty">No file selected. Upload a .zip and click any file to preview it's contents.</div>
</div>
<div style="margin-top:12px;display:flex;gap:8px;align-items:center">
</div>
<footer></footer>
</div>
</div>
<script>
const fileinput = document.getElementById('fileinput');
const dropzone = document.getElementById('dropzone');
const meta = document.getElementById('meta');
const filelist = document.getElementById('filelist');
const preview = document.getElementById('preview');
const empty = document.getElementById('empty');
const genLink = document.getElementById('genLink');
const shareURL = document.getElementById('shareURL');
const copyBtn = document.getElementById('copyBtn');
const downloadAll = document.getElementById('downloadAll');
const refresh = document.getElementById('refresh');
const clearBtn = document.getElementById('clear');
let currentZipBytes = null;
let currentFiles = [];
let currentZipName = 'recon.zip';

async function handleFile(file){
    currentZipName=file.name||'recon.zip';
    meta.textContent=`${file.name} â€” ${file.size} bytes`;
    const ab=await file.arrayBuffer();
    currentZipBytes=ab;
    await loadZipFromArrayBuffer(ab);
}

async function loadZipFromArrayBuffer(ab){
    filelist.innerHTML='';
    const zip=await JSZip.loadAsync(ab);
    const entries=[];
    zip.forEach((relativePath,zipEntry)=>{if(!zipEntry.dir){entries.push({path:relativePath,size:zipEntry._data.uncompressedSize||0,entry:zipEntry});}});
    entries.sort((a,b)=>a.path.localeCompare(b.path));
    currentFiles=entries;
    for(const f of entries){
        const li=document.createElement('li');
        li.className='fileitem';
        li.innerHTML=`<div class="fileicon">ðŸ“„</div><div style="flex:1"><div class="fname">${f.path}</div><div class="fsmall">${f.size} bytes</div></div>`;
        li.onclick=()=>{previewFile(f);};
        filelist.appendChild(li);
    }
}

async function previewFile(fileObj){
    empty.style.display='none';
    preview.innerHTML='<div style="padding:8px">Loadingâ€¦</div>';
    const blob=await fileObj.entry.async('blob');
    const type=blob.type||'text/plain';
    if(type.startsWith('image/')){
        const url=URL.createObjectURL(blob);
        preview.innerHTML=`<img src="${url}" style="max-width:100%;max-height:100%;border-radius:8px"/>`;
        return;
    }
    const txt=await blob.text();
    preview.innerHTML=`<pre class="code">${txt}</pre>`;
}

fileinput.addEventListener('change',async e=>{const f=e.target.files[0];if(f)await handleFile(f);});
dropzone.addEventListener('dragover',e=>{e.preventDefault();dropzone.style.borderColor='rgba(99,102,241,0.8)';});
dropzone.addEventListener('dragleave',e=>{e.preventDefault();dropzone.style.borderColor='rgba(255,255,255,0.06)';});
dropzone.addEventListener('drop',async e=>{e.preventDefault();dropzone.style.borderColor='rgba(255,255,255,0.06)';const f=e.dataTransfer.files[0];if(f)await handleFile(f);});

genLink.addEventListener('click',()=>{
    if(!currentZipBytes)return alert('No zip loaded');
    const bytes=new Uint8Array(currentZipBytes);
    let binary='';
    for(let i=0;i<bytes.length;i+=0x8000){binary+=String.fromCharCode.apply(null,bytes.subarray(i,i+0x8000));}
    const b64=btoa(binary);
    const compressed=LZString.compressToEncodedURIComponent(b64);
    const url=location.origin+location.pathname+'#'+compressed;
    shareURL.value=url;
    navigator.clipboard.writeText(url);
});

copyBtn.addEventListener('click',()=>{if(shareURL.value)navigator.clipboard.writeText(shareURL.value);});
downloadAll.onclick=()=>{if(!currentZipBytes)return alert('No zip loaded');const blob=new Blob([currentZipBytes],{type:'application/zip'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=currentZipName;document.body.appendChild(a);a.click();a.remove();};
refresh.addEventListener('click',()=>{if(currentZipBytes)loadZipFromArrayBuffer(currentZipBytes);});
clearBtn.addEventListener('click',()=>{currentZipBytes=null;currentFiles=[];filelist.innerHTML='';preview.innerHTML='';empty.style.display='flex';meta.textContent='No file loaded';shareURL.value='';});

(function consumeLink() {
    if (!location.hash) return;
    const compressed = location.hash.substring(1);
    if (!compressed) return;
    try {
        const base64 = LZString.decompressFromEncodedURIComponent(compressed);
        const binary = Uint8Array.from(atob(base64), c => c.charCodeAt(0));
        handleFile(new File([binary], 'recon.zip'));
        history.replaceState(null, '', location.pathname);
    } catch (e) {
        console.error('Error opening link:', e);
    }
})();
</script>
</body>

</html>

